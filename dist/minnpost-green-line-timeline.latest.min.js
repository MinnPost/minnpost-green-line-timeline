/*! minnpost-green-line-timeline - LATEST VERSION - 2014-06-10
* https://github.com/minnpost/minnpost-green-line-timeline
* Copyright (c) 2014 MinnPost; Licensed MIT */

define("helpers",["jquery","underscore"],function(a,b){var c={};return c.overrideBackboneAJAX=function(){Backbone.ajax=function(){var a=arguments;return a[0].dataTypeForce!==!0&&(a[0].dataType="jsonp",a[0].jsonpCallback="mpServerSideCachingHelper"+b.hash(a[0].url)),Backbone.$.ajax.apply(Backbone.$,a)}},c.isMSIE=function(){var a=/(msie) ([\w.]+)/i.exec(navigator.userAgent);return a?parseInt(a[2],10):!1},c.jsonpRequest=function(c,d){return options.dataType="jsonp",options.jsonpCallback="mpServerSideCachingHelper"+b.hash(options.url),d.remoteProxy&&(options.url=options.url+"&callback=mpServerSideCachingHelper",options.url=d.remoteProxy+encodeURIComponent(options.url),options.cache=!0),a.ajax.apply(a,[options])},c.getLocalData=function(d,e){var f=!1,g=[];return d=b.isArray(d)?d:[d],e&&e.paths&&0===e.paths.data.indexOf("http")&&(f=!0),b.each(d,function(b){var d;d=f?c.jsonpRequest({url:proxyPrefix+encodeURI(e.paths.data+b)},e):a.getJSON(e.paths.data+b),g.push(d)}),a.when.apply(a,g)},c.parseQueryString=function(){var a={},c=function(a){return decodeURIComponent(a.replace(/\+/g," "))},d=location.search.substring(1),e=d.split("&");return b.each(e,function(b){var d=b.split("=");d.length>1&&(a[c(d[0])]=c(d[1]))}),a},c}),define("text!templates/application.underscore",[],function(){return'<div class="application-container">\n  <div class="message-container"></div>\n\n  <div class="content-container">\n\n    <div class="timeline-jquery-greenline"></div>\n\n  </div>\n\n  <div class="footnote-container">\n    <div class="footnote">\n      <p>Some code, techniques, and data on <a href="https://github.com/minnpost/minnpost-green-line-timeline" target="_blank">Github</a>.</p>\n\n    </div>\n  </div>\n</div>\n'}),define("text!templates/loading.underscore",[],function(){return'<div class="loading-container">\n  <div class="loading"><span>Loading...</span></div>\n</div>'}),define("minnpost-green-line-timeline",["jquery","underscore","mpConfig","mpFormatters","helpers","moment","jquery-vertical-timeline","text!templates/application.underscore","text!templates/loading.underscore"],function(a,b,c,d,e,f,g,h){var i=function(c){this.options=b.extend(this.defaultOptions,c),this.el=this.options.el,this.$el=a(this.el),this.$=function(a){return this.$el.find(a)},this.loadApp()};return b.extend(i.prototype,{start:function(){this.$el.html(b.template(h,{data:{}}));var a=function(a,c,d){var e=a.date.year(),g=e.toString(),h=g.slice(0,-1),i=f(h+"0-01-01T00:00:00"),j=f(h+"9-12-31T12:59:99");return b.isUndefined(c[h])&&(c[h]={id:h,groupDisplay:h+"0s",timestamp:"newest"==d?j.unix():i.unix(),timestampStart:i.unix(),timestampEnd:j.unix()-2e3}),c};this.$(".timeline-jquery-greenline").verticalTimeline({key:"1mw9b19ubv2iesoQiNyu36t4Pkeg3UGNqhkawe8-nBdA",sheetName:"greenline",tabletopOptions:{parameterize:"//gs-proxy.herokuapp.com/proxy?url="},defaultDirection:"oldest",groupFunction:a})},defaultOptions:{projectName:"minnpost-green-line-timeline",remoteProxy:null,el:".minnpost-green-line-timeline-container",availablePaths:{local:{css:[".tmp/css/main.css"],images:"images/",data:"data/"},build:{css:["//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css","dist/minnpost-green-line-timeline.libs.min.css","dist/minnpost-green-line-timeline.latest.min.css"],ie:["dist/minnpost-green-line-timeline.libs.min.ie.css","dist/minnpost-green-line-timeline.latest.min.ie.css"],images:"dist/images/",data:"dist/data/"},deploy:{css:["//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css","https://s3.amazonaws.com/data.minnpost/projects/minnpost-green-line-timeline/minnpost-green-line-timeline.libs.min.css","https://s3.amazonaws.com/data.minnpost/projects/minnpost-green-line-timeline/minnpost-green-line-timeline.latest.min.css"],ie:["https://s3.amazonaws.com/data.minnpost/projects/minnpost-green-line-timeline/minnpost-green-line-timeline.libs.min.ie.css","https://s3.amazonaws.com/data.minnpost/projects/minnpost-green-line-timeline/minnpost-green-line-timeline.latest.min.ie.css"],images:"https://s3.amazonaws.com/data.minnpost/projects/minnpost-green-line-timeline/images/",data:"https://s3.amazonaws.com/data.minnpost/projects/minnpost-green-line-timeline/data/"}}},loadApp:function(){this.determinePaths(),this.getLocalAssests(function(a){this.renderAssests(a),this.start()})},determinePaths:function(){var a;this.options.deployment="deploy",-1!==window.location.host.indexOf("localhost")&&(this.options.deployment="local",a=e.parseQueryString(),b.isObject(a)&&b.isString(a.mpDeployment)&&(this.options.deployment=a.mpDeployment)),this.options.paths=this.options.availablePaths[this.options.deployment]},getLocalAssests:function(b){var c=this;"local"===this.options.deployment?a.getJSON("bower.json",function(a){b.apply(c,[a.dependencyMap])}):b.apply(this,[])},renderAssests:function(c){var d=e.isMSIE()&&e.isMSIE()<=8;b.isObject(c)&&b.each(c,function(c){c.css&&b.each(c.css,function(b){b=b.match(/^(http|\/\/)/)?b:"bower_components/"+b+".css",a("head").append('<link rel="stylesheet" href="'+b+'" type="text/css" />')}),c.ie&&d&&b.each(c.ie,function(b){b=b.match(/^(http|\/\/)/)?b:"bower_components/"+b+".css",a("head").append('<link rel="stylesheet" href="'+b+'" type="text/css" />')})}),b.each(this.options.paths.css,function(b){a("head").append('<link rel="stylesheet" href="'+b+'" type="text/css" />')}),d&&b.each(this.options.paths.ie,function(b){a("head").append('<link rel="stylesheet" href="'+b+'" type="text/css" />')}),this.$el.addClass("processed")}}),i}),require(["jquery","minnpost-green-line-timeline"],function(a,b){a(document).ready(function(){new b})});